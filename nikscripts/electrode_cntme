#!/bin/bash

# File used for collecting AFD values from pairwise electrode-to-electrode 
# tracts in individual patients and making a matrix of them

WORKDIR=$1
NORMDIR=$2
#setup proper directory structure
TRACKDIR=${WORKDIR}/${NORMDIR}/electrodetracking/${subj}
cd $TRACKDIR

#construct matrix
declare -A matrix

shopt -s nullglob
l="$(wc -l < ${WORKDIR}/${subj}_seeds.txt)"
for ((i=1;i<=l;i++)) do
  for ((j=1;j<=l;j++)) do
  seed="$(awk "NR == ${i}" ${WORKDIR}/${subj}_seeds.txt)"
  target="$(awk "NR == ${j}" ${WORKDIR}/${subj}_seeds.txt)"
  AFD="$(find ./* \( -name "${seed}*" -a -name "*${target}*" -a -name "*COMB_AFD.txt" \) )"
  
  if [ -s ${AFD} ]; then
    matrix[$i,$j]="$(find ./* \( -name "${seed}*" -a -name "*${target}*" -a -name "*COMB*" \) -exec cat {} \; )"
  else
    matrix[$i,$j]=0
  fi
  done
done

echo "${matrix[@]}" > ${WORKDIR}/${subj}_cntme.txt
